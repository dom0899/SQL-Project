-- vytvoření tabulky:
-- t_dominik_drazan_project_sql_primary_final

SELECT 
	cpay.value AS "mzdy",
	prmfnl.value AS "ceny",
	cpay.payroll_year AS "roky mezd za 2017 a 2018",
	date_format(prmfnl.date_from, '%Y') AS "ceny potravin za rok 2017 a 2018",
	prmfnl.region_code AS "všechny kraje z celé ČR"
FROM t_dominik_drazan_project_sql_primary_final prmfnl 
JOIN czechia_payroll cpay 
	ON  cpay.payroll_year = year(prmfnl.date_from)
WHERE cpay.value IS NOT NULL
	AND prmfnl.region_code IS NOT NULL;







-- Vytvoření tabulky:
-- t_{jmeno}_{prijmeni}_project_SQL_secondary_final




CREATE TABLE t_dominik_drazan_project_SQL_secondary_final AS 
SELECT * FROM economies e 
WHERE 1=0;



-- Nahrání dat do tabulky:
-- t_{jmeno}_{prijmeni}_project_SQL_secondary_final


INSERT INTO t_dominik_drazan_project_SQL_secondary_final 
SELECT * FROM economies; 





SELECT 
	country AS "evropské státy",
	`year` AS "roky 2017 a 2018",
	round(avg(GDP), 2) AS "hrubý domácí produkt",
	round(population, 2) AS "populace",
	gini AS "Giniho koeficient"
FROM t_dominik_drazan_project_sql_secondary_final sndrfl
WHERE country IN (
    'Germany', 'France', 'Italy', 'Spain', 'Netherlands',
    'Sweden', 'Poland', 'Belgium', 'Austria', 'Denmark', 'Finland',
    'Greece', 'Portugal', 'Ireland', 'Czech Republic', 'Romania',
    'Hungary', 'Slovakia', 'Luxembourg', 'Bulgaria', 'Slovenia',
    'Lithuania', 'Latvia', 'Cyprus', 'Estonia', 'Malta'
)
AND `year` BETWEEN 2017 AND 2018
AND gini IS NOT NULL;




































