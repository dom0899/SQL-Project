-- Sada SQL Dotazů
-- Výzkumné otázky


-- 2) Kolik je možné si koupit litrů mléka a kilogramů chleba 
-- za první a poslední srovnatelné období v dostupných datech 
-- cen a mezd?

-- code mléka: 114201
-- code chleba: 111301




SELECT cpc.name AS "název",
	avg(cpay.value)/avg(prmfnl.value) AS "množství",
	cpc.price_unit AS "jednotka",
	cpay.payroll_year AS "rok" 
FROM t_dominik_drazan_project_sql_primary_final prmfnl
JOIN czechia_payroll cpay 
	ON  cpay.payroll_year = YEAR(prmfnl.date_from) 
JOIN czechia_price_category cpc
	ON prmfnl.category_code = cpc.code
WHERE cpc.name LIKE '%chléb%'
GROUP BY cpc.name, cpay.value, cpc.price_unit, cpay.payroll_year;

-- Mléko: 3 061,3 litrů za rok 2006
-- Mléko: 2 969,1 litrů za rok 2018

-- Chléb konzumní kmínový: 2 741,2 kg za rok 2006
-- Chléb konzumní kmínový: 2 427,5 kg za rok 2018

-- Po vytvoření indexu v tabulce: t_dominik_drazan_project_sql_primary_final 
-- se vyhledávání v tabulce urychlilo o 95% 

-- Tento dotaz lze používat pro oba druhy 
-- a to jak mléko, tak i chléb. ----> Stačí vyměnit v LIKE klauzuli název.




